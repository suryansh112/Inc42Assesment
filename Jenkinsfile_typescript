pipeline {

    agent any

    tools {
        nodejs 'node'
        dockerTool 'docker'
    }
    environment {
        NODEPATH = "${WORKSPACE}/typescript"
    }
    stages{
        stage("build") {
            steps {
                echo 'BUILD EXECUTION STARTED'
                sh 'npm install typescript -g'
                sh 'tsc ${NODEPATH}/app.ts'
                sh 'node ${NODEPATH}/app.js'
            }
        }
        stage("Docker Build"){
            steps{
                sh 'docker build -t helloworldnode -f ${NODEPATH}/Dockerfile .'
            }
    }

    }
}
